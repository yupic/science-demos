<!--
Interactive science demo.
Part of the "science-demos" project.

GitHub: https://github.com/yupic/science-demos
YouTube: https://www.youtube.com/@autism-ru
Telegram: https://t.me/autism_science
License: MIT
-->
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>–≠–≤–æ–ª—é—Ü–∏—è –¥–ª–∏–Ω—ã —à–µ–∏ –∂–∏—Ä–∞—Ñ–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f5f5f5;
      --fg: #222;
      --accent: #2c7be5;
      --accent2: #e67e22;
      --muted: #666;
      --card: #fff;
      --border: #ddd;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--fg);
    }
    .container {
      margin: 0 auto;
      padding: 0 16px;
    }
    h1 {
      margin: 0 0 8px;
      font-size: 24px;
    }
    p.desc {
      margin: 0 0 16px;
      color: var(--muted);
      font-size: 14px;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
      align-items: center;
    }
    button {
      border: 1px solid var(--border);
      background: var(--card);
      border-radius: 6px;
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.15s, transform 0.1s, box-shadow 0.15s;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    button:hover {
      background: #f0f4ff;
    }
    button:active {
      transform: translateY(1px);
      box-shadow: 0 0 0 rgba(0,0,0,0.05);
    }
    .stats {
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 12px;
    }
    .stats span.value {
      color: var(--fg);
      font-weight: 600;
    }
    .card {
      background: var(--card);
      border-radius: 8px;
      padding: 12px;
      border: 1px solid var(--border);
      margin-bottom: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.03);
    }
    .card-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 6px;
    }
    canvas {
      display: block;
      width: auto;
      max-width: 100%;
      background: #fff;
    }
    .canvas-frame {
      border: 1px solid var(--border);
      border-radius: 4px;
      background: #fff;
      overflow: hidden;
    }
    .note {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
    }
    .mut-label, .slider-label {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 13px;
    }
    .mut-label input, .mut-label select {
      padding: 4px 6px;
      font-size: 13px;
    }
    .slider-label input[type="range"] {
      width: 180px;
    }
    .slider-value {
      min-width: 42px;
      display: inline-block;
      text-align: left;
      color: var(--muted);
    }
    .charts-layout {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      flex-wrap: wrap;
    }
    .charts-column {
      flex: 0 0 auto;
      width: fit-content;
      max-width: 100%;
    }
    .allele-card {
      width: 248px;
      flex-shrink: 0;
    }
    .allele-canvas {
      display: block;
    }
    .allele-legend-swatch {
      width: 14px;
      height: 14px;
      border: 1px solid var(--border);
      border-radius: 3px;
      flex-shrink: 0;
    }
    .allele-info {
      margin-top: 8px;
      font-size: 13px;
      color: var(--fg);
      line-height: 1.4;
    }
    .allele-info-title {
      font-weight: 600;
      margin-bottom: 6px;
    }
    .allele-info-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
      color: var(--muted);
    }
    .allele-info-row:last-child {
      margin-bottom: 0;
    }
    .genome-card {
      margin-top: 12px;
    }
    .genome-list {
      font-family: "SFMono-Regular", Consolas, "Liberation Mono", "Courier New", monospace;
      white-space: pre;
      font-size: 12px;
      line-height: 1.4;
      color: var(--fg);
    }
    .genome-letter {
      color: #00f;
    }
    .genome-letter-A {
      color: #fff;
    }
    .genome-letter-C {
      color: #000;
    }
    .genome-letter-G {
      color: #ff0;
    }
    .genome-letter-T {
      color: #00f;
    }
    @media (max-width: 600px) {
      h1 { font-size: 20px; }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>–≠–≤–æ–ª—é—Ü–∏—è –¥–ª–∏–Ω—ã —à–µ–∏ –∂–∏—Ä–∞—Ñ–∞</h1>
  <p class="desc">
    –ú–æ–¥–µ–ª—å: 100 –≥–µ–Ω–æ–≤ (A/T/G/C), –∫–∞–∂–¥—ã–π –¥–∞—ë—Ç –≤–∫–ª–∞–¥ –æ—Ç ‚àí2 –¥–æ +2 —Å–º. –û—Ç–±–æ—Ä —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—â–∏–π –≤–æ–∫—Ä—É–≥ 150&nbsp;—Å–º.
    –ù–∞ –∫–∞–∂–¥–æ–º –ø–æ–∫–æ–ª–µ–Ω–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–∞–¥–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ –º—É—Ç–∞—Ü–∏–π (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ –∏–ª–∏ –±–æ–ª—å—à–µ –∑–∞ —Å—á—ë—Ç —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏).
  </p>

  <details class="card" style="padding:0;">
    <summary style="cursor:pointer; padding:12px; font-weight:600; list-style:none;">
      üìò –ü–æ–∫–∞–∑–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
    </summary>
    <div style="padding:0 12px 12px 12px;">
      <div class="card-title">TL;DR ‚Äî –∫–∞–∫ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —ç—Ç—É –¥–µ–º–∫—É</div>
      <div class="note" style="font-size:13px; line-height:1.5; color:#444;">
        <ul>
          <li>–ù–∞–∂–º–∏—Ç–µ <strong>¬´–°—Ç–∞—Ä—Ç¬ª</strong>, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç–≤–æ–ª—é—Ü–∏—é –ø–æ–ø—É–ª—è—Ü–∏–∏ –∏–∑ 10&nbsp;000 –∂–∏—Ä–∞—Ñ–æ–≤ —Å ¬´–≥–µ–Ω–æ–º–æ–º¬ª –∏–∑ 100 –ø–æ–∑–∏—Ü–∏–π.</li>
          <li>–ö–∞–∂–¥—ã–π –≥–µ–Ω –¥–∞—ë—Ç –Ω–µ–±–æ–ª—å—à–æ–π –≤–∫–ª–∞–¥ –≤ –¥–ª–∏–Ω—É —à–µ–∏. –û—Ç–±–æ—Ä –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –æ—Å–æ–±–µ–π —Å –¥–ª–∏–Ω–æ–π –æ–∫–æ–ª–æ <strong>150&nbsp;—Å–º</strong> –∏ –¥–µ–ª–∞–µ—Ç –∏—Ö —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏ —á–∞—â–µ.</li>
          <li>–í–µ—Ä—Ö–Ω–∏–π –≥—Ä–∞—Ñ–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <strong>—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª–∏–Ω —à–µ–∏</strong> –≤ —Ç–µ–∫—É—â–µ–º –ø–æ–∫–æ–ª–µ–Ω–∏–∏, –Ω–∏–∂–Ω–∏–π ‚Äî <strong>–¥–∏–Ω–∞–º–∏–∫—É —Å—Ä–µ–¥–Ω–µ–π –¥–ª–∏–Ω—ã</strong> –ø–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è–º.</li>
          <li><strong>¬´–ú—É—Ç–∞—Ü–∏–∏/–ø–æ–∫–æ–ª–µ–Ω–∏–µ¬ª</strong> –∏ <strong>¬´–î–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–±–æ—Ä–∞ (œÉ)¬ª</strong> –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∏ —Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —à–∏—Ä–∏–Ω–∞ —ç–≤–æ–ª—é—Ü–∏–∏.</li>
          <li>–ë–ª–æ–∫ ¬´–¢–æ–ø-5 –¥–ª–∏–Ω–Ω—ã—Ö –∏ 5 –∫–æ—Ä–æ—Ç–∫–∏—Ö¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–º–µ—Ä—ã –≥–µ–Ω–æ–º–æ–≤; —Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Å–ø—Ä–∞–≤–∞ ‚Äî <strong>—á–∞—Å—Ç–æ—Ç—ã –±—É–∫–≤ A/C/G/T</strong> –≤ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏. –ö–ª–∏–∫–∞–π—Ç–µ –ø–æ –±—É–∫–≤–∞–º –∏ —Å—Ç—Ä–æ–∫–∞–º, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤–∫–ª–∞–¥ –∞–ª–ª–µ–ª–µ–π.</li>
          <li>–≠—Ç–æ —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å: –≤–∫–ª–∞–¥ –≥–µ–Ω–æ–≤ –ø—Ä–æ—Å—Ç–æ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –º–µ–∂–¥—É –Ω–∏–º–∏ (—ç–ø–∏—Å—Ç–∞–∑–∞) –Ω–µ—Ç, –∞ –º—É—Ç–∞—Ü–∏–∏ —É—Å–∫–æ—Ä–µ–Ω—ã, —á—Ç–æ–±—ã —ç–≤–æ–ª—é—Ü–∏—è –±—ã–ª–∞ –∑–∞–º–µ—Ç–Ω–∞ ¬´–Ω–∞ –≥–ª–∞–∑–∞—Ö¬ª.</li>
        </ul>
      </div>

      <div class="card-title">–ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ —ç—Ç–∞ –º–æ–¥–µ–ª—å</div>
      <div class="note" style="font-size:13px; line-height:1.5; color:#444;">
        <p><strong>–ß—Ç–æ –∑–¥–µ—Å—å –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç—Å—è</strong></p>
        <ul>
          <li>–í –ø–æ–ø—É–ª—è—Ü–∏–∏ –≤—Å–µ–≥–¥–∞ <strong>10&nbsp;000 –æ—Å–æ–±–µ–π</strong>.</li>
          <li>–£ –∫–∞–∂–¥–æ–π –æ—Å–æ–±–∏ –µ—Å—Ç—å ¬´–≥–µ–Ω–æ–º¬ª –¥–ª–∏–Ω–æ–π <strong>100 –ø–æ–∑–∏—Ü–∏–π</strong>. –í –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Å—Ç–æ–∏—Ç –æ–¥–Ω–∞ –±—É–∫–≤–∞: A, C, G –∏–ª–∏ T.</li>
          <li>–ö–∞–∂–¥–∞—è –±—É–∫–≤–∞ –≤ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –¥–∞—ë—Ç –Ω–µ–±–æ–ª—å—à–æ–π –≤–∫–ª–∞–¥ –≤ –ø—Ä–∏–∑–Ω–∞–∫ ‚Äî –¥–ª–∏–Ω—É —à–µ–∏. –°—É–º–º–∞ –≤–∫–ª–∞–¥–æ–≤ –ø–æ –≤—Å–µ–º –ø–æ–∑–∏—Ü–∏—è–º + –±–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ = –¥–ª–∏–Ω–∞ —à–µ–∏ –æ—Å–æ–±–∏.</li>
          <li>–û—Ç–±–æ—Ä —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—â–∏–π: –µ—Å—Ç—å <strong>–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞</strong> —à–µ–∏ (150&nbsp;—Å–º). –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–µ –∏ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ —à–µ–∏ –º–µ–Ω–µ–µ —É—Å–ø–µ—à–Ω—ã.</li>
          <li>–í –º–æ–¥–µ–ª–∏ –≤–∫–ª–∞–¥ –≥–µ–Ω–æ–≤ <strong>–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π</strong>: –Ω–∏–∫–∞–∫–∏—Ö –Ω–µ–∞–¥–¥–∏—Ç–∏–≤–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (—ç–ø–∏—Å—Ç–∞–∑–∞) –∑–¥–µ—Å—å –Ω–µ—Ç, –≤–∫–ª–∞–¥ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π –ø—Ä–æ—Å—Ç–æ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è.</li>
        </ul>

        <p><strong>–ö–∞–∫ –æ—Ç–±–æ—Ä –¥–µ–ª–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ</strong></p>
        <ul>
          <li>–£ –∫–∞–∂–¥–æ–π –æ—Å–æ–±–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è ¬´–ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω–æ—Å—Ç—å¬ª: —á–µ–º –±–ª–∏–∂–µ –µ—ë —à–µ—è –∫ 150&nbsp;—Å–º, —Ç–µ–º –≤—ã—à–µ —à–∞–Ω—Å –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Ç–æ–º–∫–æ–≤.</li>
          <li>–°–ª–µ–¥—É—é—â–µ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –ø–æ—Ç–æ–º–∫–æ–≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ:
            <ul>
              <li>–ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –¥–µ—Ç—ë–Ω—ã—à –ø–æ–ª—É—á–∞–µ—Ç –≥–µ–Ω–æ–º –æ—Ç <strong>–¥–≤—É—Ö —Ä–æ–¥–∏—Ç–µ–ª–µ–π</strong>: –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ –±–µ—Ä—ë—Ç—Å—è –±—É–∫–≤–∞ –ª–∏–±–æ —É ¬´–º–∞–º—ã¬ª, –ª–∏–±–æ —É ¬´–ø–∞–ø—ã¬ª (–ø–µ—Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è).</li>
              <li>–†–æ–¥–∏—Ç–µ–ª–∏ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ, –Ω–æ <strong>—Å –≤–µ—Å–∞–º–∏ –ø–æ –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω–æ—Å—Ç–∏</strong>: –æ—Å–æ–±–∏ –±–ª–∏–∂–µ –∫ –æ–ø—Ç–∏–º—É–º—É —á–∞—â–µ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏.</li>
            </ul>
          </li>
        </ul>

        <p><strong>–ú—É—Ç–∞—Ü–∏–∏</strong></p>
        <ul>
          <li>–ü–æ—Å–ª–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è –≤ –Ω—ë–º —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ <strong>—á–∏—Å–ª–æ –º—É—Ç–∞—Ü–∏–π</strong> ‚Äî —Ç–æ, —á—Ç–æ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ ¬´–ú—É—Ç–∞—Ü–∏–∏/–ø–æ–∫–æ–ª–µ–Ω–∏–µ¬ª.</li>
          <li>–ö–∞–∂–¥–∞—è –º—É—Ç–∞—Ü–∏—è:
            <ul>
              <li>—Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–Ω—É –æ—Å–æ–±—å –∏ –æ–¥–Ω—É –ø–æ–∑–∏—Ü–∏—é –≤ –µ—ë –≥–µ–Ω–æ–º–µ;</li>
              <li>–∑–∞–º–µ–Ω—è–µ—Ç –±—É–∫–≤—É –≤ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –¥—Ä—É–≥—É—é (A ‚Üí C/G/T –∏ —Ç.–ø.).</li>
            </ul>
          </li>
          <li>–û–¥–Ω–∞ —Ç–∞–∫–∞—è –º—É—Ç–∞—Ü–∏—è –æ–±—ã—á–Ω–æ —Å–¥–≤–∏–≥–∞–µ—Ç –¥–ª–∏–Ω—É —à–µ–∏ –ª–∏—à—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–æ–≤ ‚Äî —ç—Ç–æ <strong>–º—É—Ç–∞—Ü–∏–∏ –Ω–µ–±–æ–ª—å—à–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞</strong>.</li>
          <li>–í —Ä–µ–∞–ª—å–Ω–æ–π —ç–≤–æ–ª—é—Ü–∏–∏ –º—É—Ç–∞—Ü–∏–π —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–∏–¥–∞ –æ–±—ã—á–Ω–æ –≥–æ—Ä–∞–∑–¥–æ –º–µ–Ω—å—à–µ. –í –¥–µ–º–æ <strong>—Å–∫–æ—Ä–æ—Å—Ç—å –º—É—Ç–∞—Ü–∏–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∑–∞–≤—ã—à–µ–Ω–∞</strong>, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—ã–ª–∏ –∑–∞–º–µ—Ç–Ω—ã –∑–∞ –º–∏–Ω—É—Ç—ã, –∞ –Ω–µ –∑–∞ —Ç—ã—Å—è—á–∏ –ø–æ–∫–æ–ª–µ–Ω–∏–π.</li>
        </ul>

        <p><strong>–†–µ–∂–∏–º—ã: –ø–æ–ª–∏–≥–µ–Ω–Ω—ã–π vs –º–æ–Ω–æ–≥–µ–Ω–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫</strong></p>
        <ul>
          <li><strong>–ü–æ–ª–∏–≥–µ–Ω–Ω—ã–π</strong> (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):
            <ul>
              <li>–í –∫–∞–∂–¥–æ–π –∏–∑ 100 –ø–æ–∑–∏—Ü–∏–π –µ—Å—Ç—å <strong>4 –≤–æ–∑–º–æ–∂–Ω—ã–µ –±—É–∫–≤—ã</strong> —Å —Ä–∞–∑–Ω—ã–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º –Ω–∞ –¥–ª–∏–Ω—É —à–µ–∏.</li>
              <li>–ü—Ä–∏ —ç—Ç–æ–º –≤ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–ø—É–ª—è—Ü–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ <strong>2 –∏–∑ 4 –∞–ª–ª–µ–ª–µ–π</strong> ‚Äî –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø–æ–∑–∂–µ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –º—É—Ç–∞—Ü–∏–∏.</li>
              <li>–£–∂–µ –≤ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–ø—É–ª—è—Ü–∏–∏ –µ—Å—Ç—å –∑–∞–º–µ—Ç–Ω–æ–µ –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –æ—Ç–±–æ—Ä ¬´–ª–µ–ø–∏—Ç¬ª –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.</li>
            </ul>
          </li>
          <li><strong>–ú–æ–Ω–æ–≥–µ–Ω–Ω—ã–π</strong>:
            <ul>
              <li>–í –Ω–∞—á–∞–ª–µ –≤–æ –≤—Å–µ—Ö 100 –ø–æ–∑–∏—Ü–∏—è—Ö —Å—Ç–æ–∏—Ç –æ–¥–∏–Ω ¬´–Ω–æ—Ä–º–∞–ª—å–Ω—ã–π¬ª –≤–∞—Ä–∏–∞–Ω—Ç (A), –¥–∞—é—â–∏–π –Ω—É–ª–µ–≤–æ–π –≤–∫–ª–∞–¥.</li>
              <li>–í—Å–µ –æ—Ç–ª–∏—á–∞—é—â–∏–µ—Å—è –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤–æ–∑–Ω–∏–∫–∞—é—Ç —Ç–æ–ª—å–∫–æ <strong>—á–µ—Ä–µ–∑ –º—É—Ç–∞—Ü–∏–∏</strong> –∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –∫–∞–∫ —Å–ª–µ–≥–∫–∞ –ø–æ–ª–µ–∑–Ω—ã–π, —Ç–∞–∫ –∏ —Å–ª–µ–≥–∫–∞ –≤—Ä–µ–¥–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (–æ–±—ã—á–Ω–æ ¬±1‚Äì2&nbsp;—Å–º).</li>
              <li>–°–Ω–∞—á–∞–ª–∞ —É –≤—Å–µ—Ö –¥–ª–∏–Ω–∞ —à–µ–∏ ‚âà50&nbsp;—Å–º, –≤–∞—Ä–∏–∞—Ü–∏–∏ –ø–æ—á—Ç–∏ –Ω–µ—Ç. –°–æ –≤—Ä–µ–º–µ–Ω–µ–º, –ø–æ –º–µ—Ä–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –Ω–µ–±–æ–ª—å—à–∏—Ö –º—É—Ç–∞—Ü–∏–π, –≤–æ–∫—Ä—É–≥ 50&nbsp;—Å–º –Ω–∞—á–∏–Ω–∞—é—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è —Å–Ω–∞—á–∞–ª–∞ 49 –∏ 51, –ø–æ—Ç–æ–º 48 –∏ 52 –∏ —Ç.–¥., –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Ñ–æ—Ä–º–∏—Ä—É—è –∫–æ–ª–æ–∫–æ–ª —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.</li>
              <li>–≠—Ç–æ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ <strong>–≤–∞—Ä–∏–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞ —Å—á—ë—Ç –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –º—É—Ç–∞—Ü–∏–π –Ω–µ–±–æ–ª—å—à–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞</strong>, –∞ –Ω–µ –∏–∑-–∑–∞ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö ¬´–∫—Ä—É–ø–Ω—ã—Ö¬ª –º—É—Ç–∞—Ü–∏–π.</li>
            </ul>
          </li>
        </ul>

        <p><strong>–ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç –≥—Ä–∞—Ñ–∏–∫–∏</strong></p>
        <ul>
          <li><strong>–°—Ç—Ä–æ–∫–∞ ¬´–ü–æ–∫–æ–ª–µ–Ω–∏–µ / —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ / min / max / SD¬ª</strong> –ø–æ–¥ –ø–∞–Ω–µ–ª—å—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
            <ul>
              <li><strong>–ü–æ–∫–æ–ª–µ–Ω–∏–µ</strong> ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è.</li>
              <li><strong>–°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞</strong> ‚Äî —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ —à–µ–∏ –ø–æ –≤—Å–µ–º 10&nbsp;000 –æ—Å–æ–±—è–º.</li>
              <li><strong>min</strong> ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —à–µ–∏ –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏.</li>
              <li><strong>max</strong> ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —à–µ–∏ –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏.</li>
              <li><strong>SD</strong> ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ, —à–∏—Ä–∏–Ω–∞ ¬´–∫–æ–ª–æ–∫–æ–ª–∞¬ª (–Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –æ—Å–æ–±–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞).</li>
            </ul>
          </li>

          <li><strong>¬´–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —à–µ–∏ –≤ —Ç–µ–∫—É—â–µ–º –ø–æ–∫–æ–ª–µ–Ω–∏–∏¬ª</strong> (–≤–µ—Ä—Ö–Ω–∏–π –≥—Ä–∞—Ñ–∏–∫):
            <ul>
              <li>–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –æ—Å–æ–±–µ–π —Å –∫–∞–∂–¥–æ–π –¥–ª–∏–Ω–æ–π —à–µ–∏.</li>
              <li>–ü–æ –æ—Å–∏ X ‚Äî –¥–ª–∏–Ω–∞ —à–µ–∏ (—Å–º), –ø–æ –æ—Å–∏ Y ‚Äî —á–∏—Å–ª–æ –æ—Å–æ–±–µ–π.</li>
              <li>–ü–æ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º –æ—Ç–±–æ—Ä–∞ –∏ –º—É—Ç–∞—Ü–∏–π –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –æ–±—ã—á–Ω–æ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ <strong>–∫–æ–ª–æ–∫–æ–ª—É –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</strong>.</li>
            </ul>
          </li>

          <li><strong>¬´–î–∏–Ω–∞–º–∏–∫–∞ —Å—Ä–µ–¥–Ω–µ–π –¥–ª–∏–Ω—ã —à–µ–∏¬ª</strong> (–Ω–∏–∂–Ω–∏–π –≥—Ä–∞—Ñ–∏–∫):
            <ul>
              <li>–û—Ä–∞–Ω–∂–µ–≤–∞—è –ª–∏–Ω–∏—è ‚Äî —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ —à–µ–∏ –ø–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è–º.</li>
              <li>–°–µ—Ä–∞—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è ‚Äî –æ–ø—Ç–∏–º—É–º 150&nbsp;—Å–º.</li>
              <li>–ú–æ–∂–Ω–æ –≤–∏–¥–µ—Ç—å, –∫–∞–∫ —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫ –æ–ø—Ç–∏–º—É–º—É –∏ –∫–æ–ª–µ–±–ª–µ—Ç—Å—è –≤–æ–∫—Ä—É–≥ –Ω–µ–≥–æ.</li>
            </ul>
          </li>
        </ul>

        <p><strong>–¢–æ–ø-5 –¥–ª–∏–Ω–Ω—ã—Ö –∏ 5 –∫–æ—Ä–æ—Ç–∫–∏—Ö –æ—Å–æ–±–µ–π</strong></p>
        <ul>
          <li>–ó–¥–µ—Å—å –ø–æ–∫–∞–∑–∞–Ω—ã –≥–µ–Ω–æ–º—ã –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∞–º—ã—Ö –¥–ª–∏–Ω–Ω–æ—à–µ–∏—Ö –∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∞–º—ã—Ö –∫–æ—Ä–æ—Ç–∫–æ—à–µ–∏—Ö –æ—Å–æ–±–µ–π.</li>
          <li>–ö–∞–∂–¥–∞—è –±—É–∫–≤–∞ —Ä–∞—Å–∫—Ä–∞—à–µ–Ω–∞ –≤ —Ç–æ—Ç –∂–µ —Ü–≤–µ—Ç, —á—Ç–æ –∏ –Ω–∞ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç–µ –∞–ª–ª–µ–ª–µ–π.</li>
          <li>–ß–∏—Å–ª–æ —Å–ø—Ä–∞–≤–∞ ‚Äî –¥–ª–∏–Ω–∞ —à–µ–∏ —ç—Ç–æ–π –æ—Å–æ–±–∏ –≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö.</li>
          <li>–ú–æ–∂–Ω–æ <strong>–∫–ª–∏–∫–Ω—É—Ç—å –ø–æ –ª—é–±–æ–π –±—É–∫–≤–µ</strong>. –≠—Ç–æ:
            <ul>
              <li>–ø–æ–¥—Å–≤–µ—Ç–∏—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ø–æ–∑–∏—Ü–∏—é –Ω–∞ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç–µ;</li>
              <li>–ø–æ–∫–∞–∂–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –±—É–∫–≤—ã –≤ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø–æ–º–æ–≥–∞–µ—Ç –∏–ª–∏ –º–µ—à–∞–µ—Ç.</li>
            </ul>
          </li>
        </ul>

        <p><strong>–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–ª–ª–µ–ª–µ–π</strong></p>
        <ul>
          <li>–ö–∞–∂–¥–∞—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî <strong>–æ–¥–Ω–∞ –ø–æ–∑–∏—Ü–∏—è –≤ –≥–µ–Ω–æ–º–µ</strong> (–æ–¥–∏–Ω ¬´–≥–µ–Ω¬ª –≤ –º–æ–¥–µ–ª–∏).</li>
          <li>–î–ª–∏–Ω–∞ —Ü–≤–µ—Ç–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ø—É–ª—è—Ü–∏–∏ –Ω–µ—Å—ë—Ç –±—É–∫–≤—ã A, C, G, T –≤ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏.</li>
          <li>–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤ –∫–∞–∫–æ–π-—Ç–æ –ø–æ–∑–∏—Ü–∏–∏:
            <ul>
              <li>A —É 30% –æ—Å–æ–±–µ–π,</li>
              <li>C —É 20%,</li>
              <li>G —É 0%,</li>
              <li>T —É 50%,</li>
            </ul>
            —Ç–æ —Å—Ç—Ä–æ–∫–∞ –±—É–¥–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ –∏–∑ 30% –∫—Ä–∞—Å–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (A), 20% –∂—ë–ª—Ç–æ–≥–æ (C) –∏ 50% –∑–µ–ª—ë–Ω–æ–≥–æ (T), –ø–æ–¥—Ä—è–¥.
          </li>
          <li>–¶–≤–µ—Ç–∞:
            <ul>
              <li>A ‚Äî –∫—Ä–∞—Å–Ω—ã–π, C ‚Äî –∂—ë–ª—Ç—ã–π, G ‚Äî —Å–∏–Ω–∏–π, T ‚Äî –∑–µ–ª—ë–Ω—ã–π.</li>
            </ul>
          </li>

          <li>–í —Ä–µ–∂–∏–º–µ <strong>–ø–æ–ª–∏–≥–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞</strong> –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ <strong>—ç—Ñ—Ñ–µ–∫—Ç—ã –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –±—É–∫–≤ –≤ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã</strong> —Ç–∞–∫, —á—Ç–æ:
            <ul>
              <li>–∏—Ö –≤–∫–ª–∞–¥ –∏–¥—ë—Ç –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é: A ‚â§ C ‚â§ G ‚â§ T;</li>
              <li>–≤ —ç—Ç–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ T –≤—Å–µ–≥–¥–∞ —Å–∞–º—ã–π ¬´–ø–ª—é—Å—É—é—â–∏–π¬ª –≤–∞—Ä–∏–∞–Ω—Ç, –∞ A ‚Äî —Å–∞–º—ã–π ¬´–º–∏–Ω—É—Å—É—é—â–∏–π¬ª;</li>
              <li>–ø—Ä–∏ —ç—Ç–æ–º <strong>—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞</strong> (–Ω–∞–ø—Ä–∏–º–µ—Ä, +2&nbsp;—Å–º –∏–ª–∏ ‚àí1&nbsp;—Å–º) –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –ø–æ–∑–∏—Ü–∏–∏ –∫ –ø–æ–∑–∏—Ü–∏–∏;</li>
              <li>–≤–æ–∑–º–æ–∂–Ω—ã —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –≤—Å–µ –±—É–∫–≤—ã –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤–∫–ª–∞–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, A = C = G = T = ‚àí2&nbsp;—Å–º –∏–ª–∏ = +2&nbsp;—Å–º).</li>
            </ul>
          </li>

          <li>–í —Ä–µ–∂–∏–º–µ <strong>–º–æ–Ω–æ–≥–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞</strong>:
            <ul>
              <li>A –≤—Å–µ–≥–¥–∞ –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–∫–ª–∞–¥ 0&nbsp;—Å–º;</li>
              <li>–∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è C, G –∏ T —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç ‚àí2 –¥–æ +2&nbsp;—Å–º –∏ –∑–∞—Ç–µ–º —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π —Ç–∞–∫, —á—Ç–æ C ‚â§ G ‚â§ T;</li>
              <li>–ø–æ—ç—Ç–æ–º—É A –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –∫–∞–∫ –º–µ–Ω—å—à–µ, —Ç–∞–∫ –∏ –±–æ–ª—å—à–µ C, G –∏–ª–∏ T: A –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ ¬´—Å–∞–º–∞—è –º–∏–Ω—É—Å—É—é—â–∞—è¬ª –±—É–∫–≤–∞ –∏ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–∞–º–∞—è ¬´–ø–ª—é—Å—É—é—â–∞—è¬ª;</li>
              <li>–≤–æ–∑–º–æ–∂–Ω—ã —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ C, G –∏ T –º–µ–∂–¥—É —Å–æ–±–æ–π —Ä–∞–≤–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, C = G = T = ‚àí1&nbsp;—Å–º), –Ω–æ A –ø—Ä–∏ —ç—Ç–æ–º –æ—Å—Ç–∞—ë—Ç—Å—è 0&nbsp;—Å–º.</li>
            </ul>
          </li>

          <li>–ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É—Ç—å –ø–æ —Å—Ç—Ä–æ–∫–µ –∏–ª–∏ –ø–µ—Ä–µ–π—Ç–∏ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ ‚Üë/‚Üì, –≤ –±–ª–æ–∫–µ –Ω–∏–∂–µ –ø–æ—è–≤–∏—Ç—Å—è:
            <ul>
              <li>–Ω–æ–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏;</li>
              <li>–¥–ª—è –∫–∞–∂–¥–æ–π –±—É–∫–≤—ã ‚Äî –µ—ë –≤–∫–ª–∞–¥ –≤ –¥–ª–∏–Ω—É —à–µ–∏ (–≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö) –∏ –µ—ë —á–∞—Å—Ç–æ—Ç–∞ –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏.</li>
            </ul>
          </li>

          <li>–í–∞–∂–Ω–æ: —Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <strong>—Å—Ä–µ–¥–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∞–ª–ª–µ–ª–µ–π</strong> –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏, –∞ –Ω–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≥–µ–Ω–æ–º –æ—Ç–¥–µ–ª—å–Ω–æ–π –æ—Å–æ–±–∏.</li>
          <li>–ù–∞ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç–µ –º–æ–∂–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É:
            <ul>
              <li>–≤ –ø–æ–∑–∏—Ü–∏—è—Ö, –≥–¥–µ ¬´–ø–ª—é—Å—É—é—â–∏–µ¬ª –∞–ª–ª–µ–ª–∏ –ø–æ–º–æ–≥–∞—é—Ç –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å –¥–ª–∏–Ω—É —à–µ–∏ –∫ 150&nbsp;—Å–º, –∏—Ö —Ü–≤–µ—Ç–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –∑–∞–Ω–∏–º–∞—é—Ç –≤—Å—ë –±–æ–ª—å—à—É—é –¥–æ–ª—é —Å—Ç—Ä–æ–∫–∏;</li>
              <li>¬´–º–∏–Ω—É—Å—É—é—â–∏–µ¬ª –≤–∞—Ä–∏–∞–Ω—Ç—ã, —É–≤–æ–¥—è—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫ –æ—Ç –æ–ø—Ç–∏–º—É–º–∞, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–Ω–∏–º–∞—é—Ç –≤—Å—ë –º–µ–Ω—å—à—É—é –¥–æ–ª—é.</li>
            </ul>
          </li>
        </ul>

        <p><strong>–ö–Ω–æ–ø–∫–∏ –∏ –ø–æ–ª–∑—É–Ω–∫–∏</strong></p>
        <ul>
          <li><strong>¬´–°—Ç–∞—Ä—Ç / –ü–∞—É–∑–∞¬ª</strong> ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–ª–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —ç–≤–æ–ª—é—Ü–∏—é.</li>
          <li><strong>¬´–®–∞–≥ (1 –ø–æ–∫–æ–ª–µ–Ω–∏–µ)¬ª</strong> ‚Äî –ø—Ä–æ–¥–≤–∏–≥–∞–µ—Ç –º–æ–¥–µ–ª—å —Ä–æ–≤–Ω–æ –Ω–∞ –æ–¥–Ω–æ –ø–æ–∫–æ–ª–µ–Ω–∏–µ –≤–ø–µ—Ä—ë–¥.</li>
          <li><strong>¬´–°–±—Ä–æ—Å–∏—Ç—å¬ª</strong> ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫—É—é –∫–∞—Ä—Ç—É –∏ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Å–ª—É—á–∞–π–Ω—É—é –ø–æ–ø—É–ª—è—Ü–∏—é.</li>
          <li><strong>¬´–ü—Ä–∏–∑–Ω–∞–∫: –ü–æ–ª–∏–≥–µ–Ω–Ω—ã–π / –ú–æ–Ω–æ–≥–µ–Ω–Ω—ã–π¬ª</strong>:
            <ul>
              <li>—Ä–µ–∂–∏–º –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ (–ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–∞ –ø–æ–ø—É–ª—è—Ü–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–Ω–æ–≤–æ);</li>
              <li>–ø–æ–ª–∏–≥–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –¥–∞—ë—Ç –º–Ω–æ–≥–æ –≤–∞—Ä–∏–∞—Ü–∏–∏ —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞, –º–æ–Ω–æ–≥–µ–Ω–Ω—ã–π ‚Äî –≤–≤–æ–¥–∏—Ç –µ—ë –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ –º—É—Ç–∞—Ü–∏–∏.</li>
            </ul>
          </li>
          <li><strong>¬´–ú—É—Ç–∞—Ü–∏–∏/–ø–æ–∫–æ–ª–µ–Ω–∏–µ¬ª</strong>:
            <ul>
              <li>–∑–∞–¥–∞—ë—Ç <strong>–æ–∂–∏–¥–∞–µ–º–æ–µ</strong> —á–∏—Å–ª–æ –º—É—Ç–∞—Ü–∏–π –≤–æ –≤—Å–µ–π –ø–æ–ø—É–ª—è—Ü–∏–∏ –∑–∞ –æ–¥–Ω–æ –ø–æ–∫–æ–ª–µ–Ω–∏–µ;</li>
              <li>—á–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≥–µ–Ω–æ–≤ –∏ —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ —ç–≤–æ–ª—é—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç –Ω–æ–≤—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏.</li>
            </ul>
          </li>
          <li><strong>¬´–î–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–±–æ—Ä–∞ (œÉ)¬ª</strong>:
            <ul>
              <li>œÉ ‚Äî —à–∏—Ä–∏–Ω–∞ ¬´–≥–æ—Ä–±–∞¬ª –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω–æ—Å—Ç–∏ –≤–æ–∫—Ä—É–≥ –æ–ø—Ç–∏–º—É–º–∞;</li>
              <li><strong>–º–∞–ª–µ–Ω—å–∫–æ–µ œÉ</strong> ‚Üí —Å–∏–ª—å–Ω—ã–π –æ—Ç–±–æ—Ä: –æ—Å–æ–±–∏, —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—â–∏–µ—Å—è –æ—Ç 150&nbsp;—Å–º, –ø–æ—á—Ç–∏ –Ω–µ —Ä–∞–∑–º–Ω–æ–∂–∞—é—Ç—Å—è;</li>
              <li><strong>–±–æ–ª—å—à–æ–µ œÉ</strong> ‚Üí —Å–ª–∞–±—ã–π –æ—Ç–±–æ—Ä: –ø–æ–ø—É–ª—è—Ü–∏—è –¥–æ–ø—É—Å–∫–∞–µ—Ç —à–∏—Ä–æ–∫–∏–π —Ä–∞–∑–±—Ä–æ—Å –¥–ª–∏–Ω —à–µ–∏;</li>
              <li>—á–µ–º –º–µ–Ω—å—à–µ œÉ (–±–æ–ª—å—à–µ –¥–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–±–æ—Ä–∞), —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è —à–∞–Ω—Å—ã –Ω–∞ —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ —É –±–æ–ª–µ–µ –∏ –º–µ–Ω–µ–µ –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω—ã—Ö –æ—Å–æ–±–µ–π –∏ —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ –º–µ–Ω—è–µ—Ç—Å—è –¥–ª–∏–Ω–∞ —à–µ–∏.</li>
            </ul>
          </li>
          <li><strong>¬´–°–∫–æ—Ä–æ—Å—Ç—å (–º—Å/—à–∞–≥)¬ª</strong>:
            <ul>
              <li>—É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–º, –∫–∞–∫ –±—ã—Å—Ç—Ä–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–∏–º—É–ª—è—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏;</li>
              <li>–º–µ–Ω—å—à–µ–µ —á–∏—Å–ª–æ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –Ω–∞ —à–∞–≥ ‚Üí –±—ã—Å—Ç—Ä–µ–µ –∏–¥—É—Ç –ø–æ–∫–æ–ª–µ–Ω–∏—è.</li>
            </ul>
          </li>
          <li>–ß–∞—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (<strong>—Å–∫–æ—Ä–æ—Å—Ç—å</strong>, <strong>—á–∏—Å–ª–æ –º—É—Ç–∞—Ü–∏–π</strong>, <strong>–¥–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–±–æ—Ä–∞</strong>) –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø—Ä—è–º–æ –≤–æ –≤—Ä–µ–º—è —Å–∏–º—É–ª—è—Ü–∏–∏ –∏ —Å—Ä–∞–∑—É –≤–∏–¥–µ—Ç—å, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è —Ö–æ–¥ —ç–≤–æ–ª—é—Ü–∏–∏. –†–µ–∂–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞ (–ø–æ–ª–∏–≥–µ–Ω–Ω—ã–π/–º–æ–Ω–æ–≥–µ–Ω–Ω—ã–π) –º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ.</li>
        </ul>

        <p><strong>–ß—Ç–æ –≤–∞–∂–Ω–æ –∏–º–µ—Ç—å –≤ –≤–∏–¥—É</strong></p>
        <ul>
          <li>–≠—Ç–æ <strong>–∏–≥—Ä—É—à–µ—á–Ω–∞—è –º–æ–¥–µ–ª—å</strong>: –æ–¥–∏–Ω –ø—Ä–∏–∑–Ω–∞–∫, —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –æ—Ç–±–æ—Ä, –∑–∞–≤—ã—à–µ–Ω–Ω—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –º—É—Ç–∞—Ü–∏–π –∏ —Å–æ–≤—Å–µ–º –º–∞–ª–µ–Ω—å–∫–æ–µ —á–∏—Å–ª–æ ¬´–≥–µ–Ω–æ–≤¬ª –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ä–µ–∞–ª—å–Ω—ã–º –æ—Ä–≥–∞–Ω–∏–∑–º–æ–º.</li>
          <li>–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –æ–Ω–∞ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã—Ö –∏–¥–µ–π:
            <ul>
              <li>–∫–∞–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—â–∏–π –æ—Ç–±–æ—Ä —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç <strong>–∫–æ–ª–æ–∫–æ–ª–æ–æ–±—Ä–∞–∑–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</strong> –ø—Ä–∏–∑–Ω–∞–∫–∞;</li>
              <li>–ø–æ—á–µ–º—É –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç–±–æ—Ä–µ –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏ –Ω–µ–∏–∑–±–µ–∂–Ω–æ –æ—Å—Ç–∞—é—Ç—Å—è –∏ ¬´–º–∏–Ω—É—Å—É—é—â–∏–µ¬ª, –∏ ¬´–ø–ª—é—Å—É—é—â–∏–µ¬ª –∞–ª–ª–µ–ª–∏;</li>
              <li>–∫–∞–∫ –º–µ–Ω—è—é—Ç—Å—è —á–∞—Å—Ç–æ—Ç—ã –≥–µ–Ω–æ–≤ (—Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞) –∏ –≥–µ–Ω–æ—Ç–∏–ø—ã –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ—Å–æ–±–µ–π (—Å–ø–∏—Å–æ–∫ –≥–µ–Ω–æ–º–æ–≤) –ø–æ –º–µ—Ä–µ —ç–≤–æ–ª—é—Ü–∏–∏.</li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </details>

  <div class="controls">
    <button id="toggleBtn">–°—Ç–∞—Ä—Ç</button>
    <button id="stepBtn">–®–∞–≥ (1 –ø–æ–∫–æ–ª–µ–Ω–∏–µ)</button>
    <button id="resetBtn">–°–±—Ä–æ—Å–∏—Ç—å</button>
    <label class="mut-label">
      –ü—Ä–∏–∑–Ω–∞–∫:
      <select id="traitModeSelect">
        <option value="polygenic" selected>–ü–æ–ª–∏–≥–µ–Ω–Ω—ã–π</option>
        <option value="monogenic">–ú–æ–Ω–æ–≥–µ–Ω–Ω—ã–π</option>
      </select>
    </label>
    <label class="mut-label">
      –ú—É—Ç–∞—Ü–∏–∏/–ø–æ–∫–æ–ª–µ–Ω–∏–µ:
      <select id="mutRateSelect">
        <option value="1">1</option>
        <option value="10">10</option>
        <option value="100" selected>100</option>
        <option value="1000">1000</option>
      </select>
    </label>
    <label class="slider-label">
      –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–±–æ—Ä–∞ (œÉ):
      <input type="range" id="sigmaSlider" min="10" max="500" step="10" value="310" />
      <span class="slider-value" id="sigmaValue">200</span>
    </label>
    <label class="slider-label">
      –°–∫–æ—Ä–æ—Å—Ç—å (–º—Å/—à–∞–≥):
      <input type="range" id="speedSlider" min="0" max="5" step="1" value="0" />
      <span class="slider-value" id="speedValue">150</span>
    </label>
  </div>

  <div class="stats">
    –ü–æ–∫–æ–ª–µ–Ω–∏–µ:
    <span class="value" id="genSpan">0</span>
    &nbsp;|&nbsp; —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ —à–µ–∏:
    <span class="value" id="meanSpan">0</span> —Å–º
    &nbsp;|&nbsp; –º–∏–Ω:
    <span class="value" id="minSpan">0</span> —Å–º
    &nbsp;|&nbsp; –º–∞–∫—Å:
    <span class="value" id="maxSpan">0</span> —Å–º
    &nbsp;|&nbsp; SD:
    <span class="value" id="sdSpan">0</span> —Å–º
  </div>

  <div class="charts-layout">
    <div class="charts-column">
      <div class="card">
        <div class="card-title">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —à–µ–∏ –≤ —Ç–µ–∫—É—â–µ–º –ø–æ–∫–æ–ª–µ–Ω–∏–∏</div>
        <div class="canvas-frame">
          <canvas id="histCanvas" width="640" height="200"></canvas>
        </div>
      </div>

      <div class="card">
        <div class="card-title">–î–∏–Ω–∞–º–∏–∫–∞ —Å—Ä–µ–¥–Ω–µ–π –¥–ª–∏–Ω—ã —à–µ–∏</div>
        <div class="canvas-frame">
          <canvas id="timeCanvas" width="640" height="200"></canvas>
        </div>
        <div class="note">
          –õ–∏–Ω–∏—è ‚Äî —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ —à–µ–∏ –ø–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è–º. –ü—É–Ω–∫—Ç–∏—Ä ‚Äî –æ–ø—Ç–∏–º—É–º 150&nbsp;—Å–º.
        </div>
      </div>

      <div class="card genome-card">
        <div class="card-title">–¢–æ–ø-5 –¥–ª–∏–Ω–Ω—ã—Ö –∏ 5 –∫–æ—Ä–æ—Ç–∫–∏—Ö –æ—Å–æ–±–µ–π</div>
        <div class="genome-list" id="topGenomes">–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...</div>
      </div>
    </div>

    <div class="card allele-card">
      <div class="card-title">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–ª–ª–µ–ª–µ–π</div>
      <div class="canvas-frame">
        <canvas id="alleleCanvas" class="allele-canvas" width="220" height="520" tabindex="0" aria-label="–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–ª–ª–µ–ª–µ–π"></canvas>
      </div>
      <div class="note">–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –ø–æ–∑–∏—Ü–∏—è –≥–µ–Ω–æ–º–∞; —Ü–≤–µ—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–æ–ª–∏ A/C/G/T –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–æ–∫—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.</div>
      <div class="allele-info" id="alleleInfo">–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...</div>
    </div>
  </div>
</div>
<div style="margin-bottom:10px; font-size:12px; color:#999; text-align:center;">
  ¬© autism_science ‚Ä¢ MIT License ‚Ä¢
  <a href="https://github.com/yupic/science-demos" target="_blank" rel="noopener" style="color:#999;">GitHub</a> ‚Ä¢
  <a href="https://www.youtube.com/@autism-ru" target="_blank" rel="noopener" style="color:#999;">YouTube</a> ‚Ä¢
  <a href="https://t.me/autism_science" target="_blank" rel="noopener" style="color:#999;">Telegram</a>
</div>

<script>
(() => {
  // --- –ü–ê–†–ê–ú–ï–¢–†–´ –ú–û–î–ï–õ–ò ---
  const POP_SIZE = 10000;
  const GENOME_LENGTH = 100; // 100 –±—É–∫–≤ A/T/G/C
  const LETTERS = ['A', 'C', 'G', 'T'];
  const LETTER_INDEX = { A: 0, C: 1, G: 2, T: 3 };
  const ALLELE_COLORS = {
    A: '#e74c3c',
    C: '#f1c40f',
    G: '#2980b9',
    T: '#27ae60'
  };

  const BASE_NECK = 50;        // –±–∞–∑–æ–≤–∞—è –¥–ª–∏–Ω–∞
  const OPTIMAL_NECK = 150;    // –æ–ø—Ç–∏–º—É–º —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—â–µ–≥–æ –æ—Ç–±–æ—Ä–∞
  const NECK_MIN_AXIS = 0;     // –æ—Å—å –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ Y
  const NECK_MAX_AXIS = 200;

  const HIST_BINS = NECK_MAX_AXIS;
  const BASE_INTERVAL_MS = 150;
  const ALLELE_LINE_THICKNESS = 5; // px
  const ALLELE_LINE_LENGTH = 200;  // px
  const ALLELE_MARKER_SIZE = ALLELE_LINE_THICKNESS;
  const ALLELE_MARKER_OFFSET = ALLELE_LINE_THICKNESS;
  const ALLELE_MARKER_COLOR = '#8e44ad';
  const TOP_LONG_GENOMES = 5;
  const TOP_SHORT_GENOMES = 5;

  const TRAIT_MODES = {
    POLYGENIC: 'polygenic',
    MONOGENIC: 'monogenic'
  };

  // --- –°–û–°–¢–û–Ø–ù–ò–ï ---
  let effectMap = [];          // [–ø–æ–∑–∏—Ü–∏—è][–±—É–∫–≤–∞] -> –≤–∫–ª–∞–¥ –≤ —Å–º (‚àí5..5)
  let allowedInitial = [];     // [–ø–æ–∑–∏—Ü–∏—è] -> Set(–±—É–∫–≤), –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–ø—É–ª—è—Ü–∏–∏
  let population = [];         // [{ genome: string, neck: number }]
  let generation = 0;
  let history = [];            // [{ gen, mean, min, max }]
  let isRunning = false;
  let intervalId = null;

  let globalOffset = 0;        // –æ–∂–∏–¥–∞–µ–º—ã–π —Å—É–º–º–∞—Ä–Ω—ã–π –≤–∫–ª–∞–¥ –≥–µ–Ω–æ–≤ –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≥–µ–Ω–æ–º–∞
  let mutationRate = 10;       // –æ–∂–∏–¥–∞–µ–º–æ–µ —á–∏—Å–ª–æ –º—É—Ç–∞—Ü–∏–π –Ω–∞ –ø–æ–∫–æ–ª–µ–Ω–∏–µ
  let selectionSigma = 200;    // –¥–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–±–æ—Ä–∞
  let stepIntervalMs = BASE_INTERVAL_MS; // —Å–∫–æ—Ä–æ—Å—Ç—å —Å–∏–º—É–ª—è—Ü–∏–∏
  let selectedAllelePos = 0;
  let lastAlleleFreqs = [];
  let traitMode = TRAIT_MODES.POLYGENIC;

  // --- –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–û–ï ---
  function randInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function randomEffect() {
    // –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –æ–∫–æ–ª–æ 0, —Ä–µ–¥–∫–∏–µ –∫—Ä—É–ø–Ω—ã–µ
    const base = Math.round((Math.random() * 2 - 1) * 2); // -2..2
    if (Math.random() < 0.1) { // —Ä–µ–¥–∫–∏–µ –±–æ–ª—å—à–∏–µ
      return base * 2; // -4..4
    }
    return base;
  }

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = randInt(0, i);
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ì–ï–ù–ï–¢–ò–ö–ò ---
  function initGenetics() {
    effectMap = new Array(GENOME_LENGTH);
    allowedInitial = new Array(GENOME_LENGTH);
    globalOffset = 0;

    for (let pos = 0; pos < GENOME_LENGTH; pos++) {
      const posMap = {};

      if (traitMode === TRAIT_MODES.MONOGENIC) {
        posMap['A'] = 0;
        const mutantLetters = LETTERS.filter(letter => letter !== 'A');
        const effects = mutantLetters.map(() => randInt(-2, 2));
        const sorted = effects.slice().sort((a, b) => a - b);
        mutantLetters.forEach((letter, idx) => {
          posMap[letter] = sorted[idx];
        });
        allowedInitial[pos] = new Set(['A']);
      } else {
        const effects = LETTERS.map(() => randInt(-2, 2));
        const sorted = effects.slice().sort((a, b) => a - b);
        LETTERS.forEach((letter, idx) => {
          posMap[letter] = sorted[idx];
        });
        const shuffledLetters = shuffle(LETTERS.slice());
        // –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤—ã–±–∏—Ä–∞–µ–º —Ä–æ–≤–Ω–æ 2 —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –∞–ª–ª–µ–ª—è
        allowedInitial[pos] = new Set([shuffledLetters[0], shuffledLetters[1]]);
      }

      effectMap[pos] = posMap;
    }

    globalOffset = 0;
    for (let pos = 0; pos < GENOME_LENGTH; pos++) {
      let sum = 0;
      let count = 0;
      allowedInitial[pos].forEach(letter => {
        sum += effectMap[pos][letter];
        count++;
      });
      const meanAtPos = sum / count;
      globalOffset += meanAtPos;
    }
  }

  function randomInitialGenome() {
    const chars = [];
    for (let pos = 0; pos < GENOME_LENGTH; pos++) {
      const allowed = Array.from(allowedInitial[pos]);
      const chosen = allowed[randInt(0, allowed.length - 1)];
      chars.push(chosen);
    }
    return chars.join('');
  }

  function computeNeck(genome) {
    let sum = 0;
    for (let i = 0; i < GENOME_LENGTH; i++) {
      const letter = genome[i];
      sum += effectMap[i][letter];
    }
    return BASE_NECK + (sum - globalOffset);
  }

  function createIndividual(genome) {
    const neck = computeNeck(genome);
    return { genome, neck };
  }

  function computeFitness(neck) {
    const diff = neck - OPTIMAL_NECK;
    const sigma = selectionSigma; // —á–µ–º –±–æ–ª—å—à–µ sigma, —Ç–µ–º —Å–ª–∞–±–µ–µ –æ—Ç–±–æ—Ä
    return Math.exp(-0.5 * (diff * diff) / (sigma * sigma));
  }

  function recombineGenomes(g1, g2) {
    const len = g1.length;
    const child = new Array(len);
    let i = 0;

    while (i < len) {
      let bits = (Math.random() * 0x100000000) >>> 0;

      for (let k = 0; k < 32 && i < len; k++, i++) {
        child[i] = (bits & 1) ? g1[i] : g2[i];
        bits >>>= 1;
      }
    }

    return child.join('');
  }

  function chooseParentIndex(cumFitness) {
    const total = cumFitness[cumFitness.length - 1];
    let r = Math.random() * total;
    let lo = 0;
    let hi = cumFitness.length - 1;
    while (lo < hi) {
      const mid = (lo + hi) >> 1;
      if (r <= cumFitness[mid]) {
        hi = mid;
      } else {
        lo = mid + 1;
      }
    }
    return lo;
  }

  function applyMutations(pop) {
    const n = pop.length;
    let lambda = Math.max(0, mutationRate);
    const full = Math.floor(lambda);
    const frac = lambda - full;

    let totalMut = full;
    if (Math.random() < frac) totalMut++;

    for (let k = 0; k < totalMut; k++) {
      const mutChildIdx = randInt(0, n - 1);
      const mutPos = randInt(0, GENOME_LENGTH - 1);
      let gChars = pop[mutChildIdx].genome.split('');
      const oldBase = gChars[mutPos];
      let newBase = oldBase;
      while (newBase === oldBase) {
        newBase = LETTERS[randInt(0, LETTERS.length - 1)];
      }
      gChars[mutPos] = newBase;
      const newGenome = gChars.join('');
      pop[mutChildIdx].genome = newGenome;
      pop[mutChildIdx].neck = computeNeck(newGenome);
    }
  }

  function makeNextGeneration(pop) {
    const n = pop.length;
    const cumFitness = new Array(n);
    let sumFit = 0;
    for (let i = 0; i < n; i++) {
      const f = computeFitness(pop[i].neck);
      sumFit += f;
      cumFitness[i] = sumFit;
    }

    const newPop = new Array(n);
    for (let i = 0; i < n; i++) {
      const momIdx = chooseParentIndex(cumFitness);
      const dadIdx = chooseParentIndex(cumFitness);
      const mother = pop[momIdx];
      const father = pop[dadIdx];
      const genome = recombineGenomes(mother.genome, father.genome);
      newPop[i] = createIndividual(genome);
    }

    // –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –º—É—Ç–∞—Ü–∏–π –≤ —ç—Ç–æ–º –ø–æ–∫–æ–ª–µ–Ω–∏–∏
    applyMutations(newPop);
    return newPop;
  }

  function computeStats(pop) {
    let mean = 0;
    let m2 = 0;
    let min = Infinity;
    let max = -Infinity;
    let count = 0;
    for (const { neck } of pop) {
      count += 1;
      if (neck < min) min = neck;
      if (neck > max) max = neck;
      const delta = neck - mean;
      mean += delta / count;
      const delta2 = neck - mean;
      m2 += delta * delta2;
    }
    const variance = m2 / count;
    const sd = Math.sqrt(variance);
    return {
      mean,
      min,
      max,
      sd
    };
  }

  function recordStats() {
    const s = computeStats(population);
    history.push({
      gen: generation,
      mean: s.mean,
      min: s.min,
      max: s.max,
      sd: s.sd
    });
  }

  // --- –†–ò–°–û–í–ê–ù–ò–ï: –ì–ò–°–¢–û–ì–†–ê–ú–ú–ê ---
  const histCanvas = document.getElementById('histCanvas');
  const histCtx = histCanvas.getContext('2d');

  function drawHistogram(pop) {
    const ctx = histCtx;
    const rect = histCanvas.getBoundingClientRect();
    const w = rect.width;
    const h = rect.height;
    ctx.clearRect(0, 0, w, h);

    const margin = { left: 20, right: 20, top: 10, bottom: 20 };
    const plotW = w - margin.left - margin.right;
    const plotH = h - margin.top - margin.bottom;

    ctx.fillStyle = '#ffffff';
    ctx.fillRect(margin.left, margin.top, plotW, plotH);

    const minX = NECK_MIN_AXIS;
    const maxX = NECK_MAX_AXIS;
    const binCount = HIST_BINS;
    const binSize = (maxX - minX) / binCount;
    const bins = new Array(binCount).fill(0);

    for (const ind of pop) {
      let v = ind.neck;
      if (v < minX) v = minX;
      if (v > maxX) v = maxX - 1e-6;
      const idx = Math.floor((v - minX) / binSize);
      bins[idx]++;
    }

    const maxBin = Math.max(...bins, 1);

    ctx.strokeStyle = '#e0e0e0';
    ctx.lineWidth = 1;
    const gridYSteps = 4;
    for (let i = 0; i <= gridYSteps; i++) {
      const y = margin.top + (plotH * i) / gridYSteps;
      ctx.beginPath();
      ctx.moveTo(margin.left, y);
      ctx.lineTo(margin.left + plotW, y);
      ctx.stroke();
    }

    const barWidth = plotW / binCount;
    const rectWidth = barWidth - (barWidth >= 2 ? 1 : 0);
    ctx.fillStyle = '#2c7be5';
    for (let i = 0; i < binCount; i++) {
      const count = bins[i];
      const barHeight = (count / maxBin) * plotH;
      const x = margin.left + i * barWidth;
      const y = margin.top + plotH - barHeight;
      ctx.fillRect(x, y, rectWidth, barHeight);
    }

    ctx.strokeStyle = '#000';
    ctx.lineWidth = 1.2;
    ctx.beginPath();
    ctx.moveTo(margin.left, margin.top + plotH);
    ctx.lineTo(margin.left + plotW, margin.top + plotH);
    ctx.stroke();

    ctx.fillStyle = '#333';
    ctx.font = '12px system-ui';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';
    const ticks = 4;
    for (let i = 0; i <= ticks; i++) {
      const v = minX + ((maxX - minX) * i) / ticks;
      const x = margin.left + (plotW * i) / ticks;
      const y = margin.top + plotH + 4;
      ctx.fillText(Math.round(v), x, y);
    }
    ctx.textAlign = 'left';
    ctx.fillText('–î–ª–∏–Ω–∞ —à–µ–∏, —Å–º', margin.left + 30, margin.top + plotH + 4 /*h - 30*/);
  }

  // --- –†–ò–°–û–í–ê–ù–ò–ï: –í–†–ï–ú–Ø ---
  const timeCanvas = document.getElementById('timeCanvas');
  const timeCtx = timeCanvas.getContext('2d');

  function drawTimeSeries() {
    const ctx = timeCtx;
    const rect = timeCanvas.getBoundingClientRect();
    const w = rect.width;
    const h = rect.height;
    ctx.clearRect(0, 0, w, h);

    if (history.length === 0) return;

    const margin = { left: 20, right: 20, top: 0, bottom: 20 };
    const plotW = w - margin.left - margin.right;
    const plotH = h - margin.top - margin.bottom;

    ctx.fillStyle = '#ffffff';
    ctx.fillRect(margin.left, margin.top, plotW, plotH);

    const minY = NECK_MIN_AXIS;
    const maxY = NECK_MAX_AXIS;

    const lastGen = history[history.length - 1].gen;
    // –î–û 1000 –ø–æ–∫–æ–ª–µ–Ω–∏–π —à–∫–∞–ª–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ 0..1000, –¥–∞–ª—å—à–µ —Ç—è–Ω–µ—Ç—Å—è –∑–∞ –ª–∏–Ω–∏–µ–π
    const maxGen = Math.max(1000, lastGen);

    // –°–µ—Ç–∫–∞ –ø–æ Y
    ctx.strokeStyle = '#e0e0e0';
    ctx.lineWidth = 1;
    const gridYSteps = 4;
    for (let i = 0; i <= gridYSteps; i++) {
      const y = margin.top + (plotH * i) / gridYSteps;
      ctx.beginPath();
      ctx.moveTo(margin.left, y);
      ctx.lineTo(margin.left + plotW, y);
      ctx.stroke();
    }

    // –õ–∏–Ω–∏—è –æ–ø—Ç–∏–º—É–º–∞
    const optY = margin.top + plotH - ((OPTIMAL_NECK - minY) / (maxY - minY)) * plotH;
    ctx.save();
    ctx.strokeStyle = '#999';
    ctx.setLineDash([4, 4]);
    ctx.beginPath();
    ctx.moveTo(margin.left, optY);
    ctx.lineTo(margin.left + plotW, optY);
    ctx.stroke();
    ctx.restore();

    // –õ–∏–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π –¥–ª–∏–Ω—ã
    ctx.strokeStyle = '#e67e22';
    ctx.lineWidth = 2;
    ctx.beginPath();
    history.forEach((pt, idx) => {
      const x = margin.left + (plotW * pt.gen) / maxGen;
      const y = margin.top + plotH - ((pt.mean - minY) / (maxY - minY)) * plotH;
      if (idx === 0) ctx.moveTo(x, y);
      else ctx.lineTo(x, y);
    });
    ctx.stroke();

    // –í–´–î–ï–õ–Ø–ï–ú –ü–û–°–õ–ï–î–ù–Æ–Æ –¢–û–ß–ö–£
    const last = history[history.length - 1];
    const lastX = margin.left + (plotW * last.gen) / maxGen;
    const lastY = margin.top + plotH - ((last.mean - minY) / (maxY - minY)) * plotH;
    ctx.beginPath();
    ctx.fillStyle = '#e67e22';
    ctx.arc(lastX, lastY, 4, 0, Math.PI * 2); // –∫—Ä—É–∂–æ–∫ —Ç–æ–ª—â–µ –ª–∏–Ω–∏–∏
    ctx.fill();

    ctx.font = '12px system-ui';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';
    ctx.fillText(last.mean.toFixed(1), lastX, lastY - 20);

    // –û—Å—å X (–ø–æ–∫–æ–ª–µ–Ω–∏—è)
    ctx.strokeStyle = '#000';
    ctx.lineWidth = 1.2;
    ctx.beginPath();
    ctx.moveTo(margin.left, margin.top + plotH);
    ctx.lineTo(margin.left + plotW, margin.top + plotH);
    ctx.stroke();

    ctx.fillStyle = '#333';
    ctx.font = '12px system-ui';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';
    const ticks = 4;
    for (let i = 0; i <= ticks; i++) {
      const g = Math.round((maxGen * i) / ticks);
      const x = margin.left + (plotW * i) / ticks;
      const y = margin.top + plotH + 4;
      ctx.fillText(g, x, y);
    }

    ctx.textAlign = 'left';
    ctx.fillText('–ü–æ–∫–æ–ª–µ–Ω–∏–µ', margin.left + 30, margin.top + plotH + 4 /*h - 20*/);
  }

  // --- –†–ò–°–û–í–ê–ù–ò–ï: –ê–õ–õ–ï–õ–ò ---
  const alleleCanvas = document.getElementById('alleleCanvas');
  const alleleCtx = alleleCanvas.getContext('2d');
  const ALLELE_MARGIN = 10;

  function ensureAlleleCanvasSize() {
    const width = ALLELE_MARGIN * 2 + ALLELE_LINE_LENGTH;
    const height = ALLELE_MARGIN * 2 + GENOME_LENGTH * ALLELE_LINE_THICKNESS;
    const ratio = window.devicePixelRatio || 1;
    alleleCanvas.width = Math.round(width * ratio);
    alleleCanvas.height = Math.round(height * ratio);
    alleleCanvas.style.width = `${width}px`;
    alleleCanvas.style.height = `${height}px`;
    alleleCtx.setTransform(ratio, 0, 0, ratio, 0, 0);
  }

  function computeAlleleFrequencies(pop) {
    const total = pop.length;
    if (!total) return [];

    const genomeLen = GENOME_LENGTH;
    const counts = Array.from({ length: genomeLen }, () => [0, 0, 0, 0]);

    for (let p = 0; p < total; p++) {
      const genome = pop[p].genome;
      for (let i = 0; i < genomeLen; i++) {
        counts[i][LETTER_INDEX[genome[i]]]++;
      }
    }

    const scale = 100 / total;
    const result = new Array(genomeLen);

    for (let i = 0; i < genomeLen; i++) {
      const c = counts[i];
      result[i] = {
        A: c[0] * scale,
        C: c[1] * scale,
        G: c[2] * scale,
        T: c[3] * scale,
      };
    }

    return result;
  }

  function drawAlleleFrequencies(pop) {
    const freqs = computeAlleleFrequencies(pop);
    lastAlleleFreqs = freqs;
    alleleCtx.clearRect(0, 0, alleleCanvas.width, alleleCanvas.height);
    let y = ALLELE_MARGIN;
    for (let pos = 0; pos < freqs.length; pos++) {
      let x = ALLELE_MARGIN;
      LETTERS.forEach(letter => {
        const seg = (freqs[pos][letter] / 100) * ALLELE_LINE_LENGTH;
        alleleCtx.fillStyle = ALLELE_COLORS[letter];
        alleleCtx.fillRect(x, y, seg, ALLELE_LINE_THICKNESS);
        x += seg;
      });
      y += ALLELE_LINE_THICKNESS;
    }

    if (selectedAllelePos >= 0 && selectedAllelePos < GENOME_LENGTH) {
      const markerY = ALLELE_MARGIN + selectedAllelePos * ALLELE_LINE_THICKNESS;
      alleleCtx.fillStyle = ALLELE_MARKER_COLOR;
      const leftX = ALLELE_MARGIN - ALLELE_MARKER_OFFSET - ALLELE_MARKER_SIZE;
      const rightX = ALLELE_MARGIN + ALLELE_LINE_LENGTH + ALLELE_MARKER_OFFSET;
      alleleCtx.fillRect(leftX, markerY, ALLELE_MARKER_SIZE, ALLELE_MARKER_SIZE);
      alleleCtx.fillRect(rightX, markerY, ALLELE_MARKER_SIZE, ALLELE_MARKER_SIZE);
    }

    alleleCtx.lineWidth = 1;
    alleleCtx.strokeStyle = '#ccc';
    alleleCtx.strokeRect(ALLELE_MARGIN - 0.5, ALLELE_MARGIN - 0.5, ALLELE_LINE_LENGTH + 1, GENOME_LENGTH * ALLELE_LINE_THICKNESS + 1);
    return freqs;
  }

  // --- UI –û–ë–ù–û–í–õ–ï–ù–ò–ï ---
  const genSpan = document.getElementById('genSpan');
  const meanSpan = document.getElementById('meanSpan');
  const minSpan = document.getElementById('minSpan');
  const maxSpan = document.getElementById('maxSpan');
  const sdSpan = document.getElementById('sdSpan');
  const toggleBtn = document.getElementById('toggleBtn');
  const stepBtn = document.getElementById('stepBtn');
  const resetBtn = document.getElementById('resetBtn');
  const traitModeSelect = document.getElementById('traitModeSelect');
  const mutRateSelect = document.getElementById('mutRateSelect');
  const sigmaSlider = document.getElementById('sigmaSlider');
  const speedSlider = document.getElementById('speedSlider');
  const sigmaValue = document.getElementById('sigmaValue');
  const speedValue = document.getElementById('speedValue');
  const alleleInfo = document.getElementById('alleleInfo');
  const topGenomes = document.getElementById('topGenomes');

  let alleleInfoReady = false;
  let alleleInfoTitle = null;
  let alleleInfoPlaceholder = null;
  let alleleInfoContent = null;
  const alleleInfoValues = {};

  const clampAllelePos = (pos) => Math.min(Math.max(pos, 0), GENOME_LENGTH - 1);

  const sliderValueToSigma = (value) => 510 - value;
  const sliderValueToInterval = (value) => Math.max(5, BASE_INTERVAL_MS / Math.pow(2, value));

  function selectAllele(pos) {
    selectedAllelePos = clampAllelePos(pos);
    drawAlleleFrequencies(population);
    showAlleleInfo(selectedAllelePos);
  }

  function ensureAlleleInfoElements() {
    if (alleleInfoReady) return;

    alleleInfo.innerHTML = '';

    alleleInfoPlaceholder = document.createElement('div');
    alleleInfoPlaceholder.className = 'allele-info-placeholder';
    alleleInfoPlaceholder.textContent = '–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...';
    alleleInfo.appendChild(alleleInfoPlaceholder);

    alleleInfoContent = document.createElement('div');
    alleleInfoContent.className = 'allele-info-content';
    alleleInfo.appendChild(alleleInfoContent);

    alleleInfoTitle = document.createElement('div');
    alleleInfoTitle.className = 'allele-info-title';
    alleleInfoContent.appendChild(alleleInfoTitle);

    LETTERS.forEach(letter => {
      const row = document.createElement('div');
      row.className = 'allele-info-row';

      const swatch = document.createElement('div');
      swatch.className = 'allele-legend-swatch';
      swatch.style.background = ALLELE_COLORS[letter];

      const text = document.createElement('div');
      alleleInfoValues[letter] = text;

      row.appendChild(swatch);
      row.appendChild(text);
      alleleInfoContent.appendChild(row);
    });

    alleleInfoReady = true;
  }

  function showAlleleInfo(pos) {
    ensureAlleleInfoElements();

    if (!lastAlleleFreqs || lastAlleleFreqs.length === 0) {
      alleleInfoPlaceholder.textContent = '–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–æ–∫—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤–∫–ª–∞–¥ –±—É–∫–≤ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏.';
      alleleInfoPlaceholder.style.display = 'block';
      alleleInfoContent.style.display = 'none';
      return;
    }

    alleleInfoPlaceholder.style.display = 'none';
    alleleInfoContent.style.display = 'block';

    if (pos < 0 || pos >= GENOME_LENGTH) {
      pos = selectedAllelePos;
    }
    selectedAllelePos = pos;

    const effects = effectMap[pos];
    const freqs = lastAlleleFreqs[pos];
    alleleInfoTitle.textContent = `–ü–æ–∑–∏—Ü–∏—è ${pos}`;

    LETTERS.forEach(letter => {
      const effectVal = effects[letter];
      const freqVal = freqs ? freqs[letter] : 0;
      alleleInfoValues[letter].textContent = `${letter}: ${effectVal >= 0 ? '+' : ''}${effectVal} —Å–º, ${freqVal.toFixed(1)}%`;
    });
  }

  function updateSigmaFromSlider() {
    const v = parseFloat(sigmaSlider.value);
    selectionSigma = sliderValueToSigma(!Number.isNaN(v) ? v : 810);
    sigmaValue.textContent = selectionSigma.toFixed(0);
  }

  function updateSpeedFromSlider() {
    const v = parseFloat(speedSlider.value);
    stepIntervalMs = sliderValueToInterval(!Number.isNaN(v) ? v : 0);
    const text = stepIntervalMs.toFixed(1).replace(/\.0$/, '');
    speedValue.textContent = text;
    if (isRunning) {
      clearInterval(intervalId);
      intervalId = setInterval(stepSimulation, stepIntervalMs);
    }
  }

  function updateMutationFromSelect() {
    const v = parseFloat(mutRateSelect.value);
    if (!Number.isNaN(v) && v >= 0) {
      mutationRate = v;
    }
  }

  function updateStatsUI() {
    const last = history[history.length - 1];
    genSpan.textContent = last.gen;
    meanSpan.textContent = last.mean.toFixed(1);
    minSpan.textContent = last.min.toFixed(1);
    maxSpan.textContent = last.max.toFixed(1);
    sdSpan.textContent = last.sd.toFixed(2);
  }

  function colorizeGenome(genome) {
    return genome
      .split('')
      .map((letter, idx) =>
        `<span class="genome-letter-${letter}" data-pos="${idx}" style="background-color:${ALLELE_COLORS[letter] || 'inherit'}; cursor: pointer;">${letter}</span>`
      )
      .join('');
  }

  function renderTopGenomes(pop) {
    if (!pop || pop.length === 0) {
      topGenomes.textContent = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
      return;
    }

    const indexed = pop
      .map((ind, idx) => ({ ...ind, index: idx }))
      .sort((a, b) => {
        if (b.neck !== a.neck) return b.neck - a.neck;
        const genomeCmp = a.genome.localeCompare(b.genome);
        if (genomeCmp !== 0) return genomeCmp;
        return a.index - b.index;
      });

    const topLongest = indexed.slice(0, TOP_LONG_GENOMES);
    const shortestCandidates = indexed.slice(-TOP_SHORT_GENOMES);
    const seen = new Set(topLongest.map(ind => ind.index));
    const topShortest = shortestCandidates.filter(ind => {
      if (seen.has(ind.index)) return false;
      seen.add(ind.index);
      return true;
    });

    const combined = topLongest.concat(topShortest);

    const frag = document.createDocumentFragment();
    combined.forEach(ind => {
      const row = document.createElement('div');
      row.className = 'genome-row';
      row.style.display = 'flex';
      row.style.alignItems = 'center';

      const genomeSpan = document.createElement('div');
      genomeSpan.className = 'genome-letter-row';
      genomeSpan.style.whiteSpace = 'pre';
      genomeSpan.innerHTML = colorizeGenome(ind.genome);
      genomeSpan.addEventListener('click', (evt) => {
        const target = evt.target;
        const pos = Number.parseInt(target.dataset?.pos, 10);
        if (!Number.isNaN(pos)) {
          selectAllele(pos);
          alleleCanvas.focus({ preventScroll: true });
        }
      });
      row.appendChild(genomeSpan);

      const suffix = document.createElement('div');
      suffix.textContent = ` ${ind.neck.toFixed(0)} —Å–º`;
      suffix.style.whiteSpace = 'pre';
      suffix.style.minWidth = '7ch';
      row.appendChild(suffix);

      frag.appendChild(row);
    });

    topGenomes.replaceChildren(frag);
  }

  function updateUI() {
    drawHistogram(population);
    drawTimeSeries();
    drawAlleleFrequencies(population);
    updateStatsUI();
    showAlleleInfo(selectedAllelePos);
    renderTopGenomes(population);
  }

  // --- –°–ò–ú–£–õ–Ø–¶–ò–Ø ---
  function initSimulation() {
    isRunning = false;
    if (intervalId !== null) {
      clearInterval(intervalId);
      intervalId = null;
    }
    traitModeSelect.disabled = false;
    generation = 0;
    history = [];
    selectedAllelePos = 0;
    lastAlleleFreqs = [];
    traitMode = traitModeSelect.value === TRAIT_MODES.MONOGENIC ? TRAIT_MODES.MONOGENIC : TRAIT_MODES.POLYGENIC;
    initGenetics();

    updateMutationFromSelect();
    updateSigmaFromSlider();
    updateSpeedFromSlider();

    population = new Array(POP_SIZE);
    for (let i = 0; i < POP_SIZE; i++) {
      const genome = randomInitialGenome();
      population[i] = createIndividual(genome);
    }
    recordStats();
    updateUI();
    toggleBtn.textContent = '–°—Ç–∞—Ä—Ç';
  }

  function stepSimulation() {
    population = makeNextGeneration(population);
    generation++;
    recordStats();
    updateUI();
  }

  function startSimulation() {
    if (isRunning) return;
    isRunning = true;
    toggleBtn.textContent = '–ü–∞—É–∑–∞';
    traitModeSelect.disabled = true;
    intervalId = setInterval(stepSimulation, stepIntervalMs);
  }

  function stopSimulation() {
    if (!isRunning) return;
    isRunning = false;
    toggleBtn.textContent = '–°—Ç–∞—Ä—Ç';
    traitModeSelect.disabled = false;
    if (intervalId !== null) {
      clearInterval(intervalId);
      intervalId = null;
    }
  }

  // --- –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ---
  toggleBtn.addEventListener('click', () => {
    if (isRunning) stopSimulation();
    else startSimulation();
  });

  stepBtn.addEventListener('click', () => {
    if (!isRunning) {
      stepSimulation();
    }
  });

  resetBtn.addEventListener('click', () => {
    initSimulation();
  });

  traitModeSelect.addEventListener('change', () => {
    traitMode = traitModeSelect.value === TRAIT_MODES.MONOGENIC ? TRAIT_MODES.MONOGENIC : TRAIT_MODES.POLYGENIC;
    initSimulation();
  });

  mutRateSelect.addEventListener('change', updateMutationFromSelect);
  sigmaSlider.addEventListener('input', updateSigmaFromSlider);
  speedSlider.addEventListener('input', updateSpeedFromSlider);

  alleleCanvas.addEventListener('click', (evt) => {
    const rect = alleleCanvas.getBoundingClientRect();
    const scaleY = alleleCanvas.height / rect.height;
    const y = (evt.clientY - rect.top) * scaleY;
    const pos = Math.floor((y - ALLELE_MARGIN) / ALLELE_LINE_THICKNESS);
    if (pos >= 0 && pos < GENOME_LENGTH) {
      selectAllele(pos);
      alleleCanvas.focus({ preventScroll: true });
    } else {
      showAlleleInfo(-1);
    }
  });

  alleleCanvas.addEventListener('keydown', (evt) => {
    if (evt.key === 'ArrowUp' || evt.key === 'ArrowDown') {
      evt.preventDefault();
      const delta = evt.key === 'ArrowUp' ? -1 : 1;
      selectAllele(selectedAllelePos + delta);
    }
  });

  function resizeCanvases() {
    [histCanvas, timeCanvas].forEach(canvas => {
      const rect = canvas.getBoundingClientRect();
      const cssWidth = canvas.clientWidth || rect.width;
      const cssHeight = canvas.clientHeight || rect.height;
      if (rect.width > 0) {
        const ratio = window.devicePixelRatio || 1;
        canvas.style.width = `${cssWidth}px`;
        canvas.style.height = `${cssHeight}px`;
        canvas.width = Math.round(rect.width * ratio);
        canvas.height = Math.round(rect.height * ratio);
        const ctx = canvas.getContext('2d');
        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
      }
    });
    ensureAlleleCanvasSize();
    updateUI();
  }
  window.addEventListener('resize', resizeCanvases);

  // –°—Ç–∞—Ä—Ç
  showAlleleInfo(-1);
  initSimulation();
  resizeCanvases();
})();
</script>
</body>
</html>
